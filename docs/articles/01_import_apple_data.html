<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Import Health Data
">
<title>1. Import Apple Health Data • health2R</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="1. Import Apple Health Data">
<meta property="og:description" content="Import Health Data
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">health2R</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01_import_apple_data.html">1. Import Apple Health Data</a>
    <a class="dropdown-item" href="../articles/02_analyse_health_data.html">2. Analyse Health Data</a>
    <a class="dropdown-item" href="../articles/03_differential_privacy.html">3. Add Differential Privacy</a>
    <a class="dropdown-item" href="../articles/04_analyse_workout_data.html">4. Analyse Workout Data</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/marianapatino/health2R/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>1. Import Apple Health Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/marianapatino/health2R/blob/HEAD/vignettes/01_import_apple_data.Rmd" class="external-link"><code>vignettes/01_import_apple_data.Rmd</code></a></small>
      <div class="d-none name"><code>01_import_apple_data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="importing-data">Importing Data<a class="anchor" aria-label="anchor" href="#importing-data"></a>
</h2>
<p>Apple Health data is stored in very large xml files which can be
exported as a zip file, but have tens of millions of rows (e.g. for many
data types, health data is logged and stored at the second level).
Therefore, the <code>import_healthdata</code> and
<code>import_workouts</code> functions take an exported zip file as
input and parse it into an R data format. Due to the very large amount
of rows, this can take up to several minutes, and should therefore be
done once per updated health file, which can subsequently be stored as
an <code>rds</code> or <code>csv</code> file.</p>
<div class="section level3">
<h3 id="importing-health-data">Importing Health Data<a class="anchor" aria-label="anchor" href="#importing-health-data"></a>
</h3>
<p>First, we import, parse and save the an example dataset of health
data. A dynamic progress bar tracks the progress of the parsing
process.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/marianapatino/health2R/" class="external-link">health2R</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">parsed_healthdata</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/import_healthdata.html">import_healthdata</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"../dev/data/mp_export.zip"</span>,</span>
<span>                    datasource <span class="op">=</span> <span class="st">"apple"</span><span class="op">)</span></span></code></pre></div>
<p><img src="progressbar.png"></p>
<p>To get a first overview, we sample a random subset of 5 rows from the
parsed data frame:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parsed_healthdata</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html" class="external-link">sample_n</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 9</span></span></span>
<span><span class="co">#&gt;   type                 sourceName sourceVersion unit  device startDate          </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> HKQuantityTypeIdent… Mariana ’… 9.1           count &lt;&lt;HKD… 2022-12-18 <span style="color: #949494;">07:51:12</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> HKQuantityTypeIdent… Mariana ’… 9.3.1         count &lt;&lt;HKD… 2023-05-05 <span style="color: #949494;">23:23:32</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> HKQuantityTypeIdent… Mariana ’… 10.0          coun… &lt;&lt;HKD… 2023-10-03 <span style="color: #949494;">09:06:01</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> HKQuantityTypeIdent… Mariana ’… 9.5.1         kcal  &lt;&lt;HKD… 2023-06-20 <span style="color: #949494;">16:07:06</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> HKQuantityTypeIdent… Mariana ’… 9.6.1         kcal  &lt;&lt;HKD… 2023-08-26 <span style="color: #949494;">15:01:33</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3 more variables: endDate &lt;dttm&gt;, creationDate &lt;dttm&gt;, value &lt;chr&gt;</span></span></span></code></pre></div>
<p>After the parsing is complete, we store the parsed file as an ´rds´
file:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">parsed_healthdata</span>,</span>
<span>        <span class="st">"../dev/data/parsed_healthdata_mp.rds"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="importing-workout-data">Importing Workout Data<a class="anchor" aria-label="anchor" href="#importing-workout-data"></a>
</h3>
<p>Similarly, the <code>import_workouts</code> function imports workouts
as a list of <code>gpx</code> data, where the name of the individual
list entries is the route name.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parsed_workouts</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/import_workouts.html">import_workouts</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"../dev/data/mp_export.zip"</span>,</span>
<span>                  datasource <span class="op">=</span> <span class="st">"apple"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">parsed_workouts</span>,</span>
<span>        <span class="st">"../dev/data/parsed_apple_workouts_mp.rds"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parsed_workouts</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="op">~</span> <span class="va">.x</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`Route 2022-03-28 9:23pm`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 8</span></span></span>
<span><span class="co">#&gt;     lat   lon   ele time                 speed course  hAcc  vAcc</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  10.5 -<span style="color: #BB0000;">84.8</span>  633. 2022-03-28 <span style="color: #949494;">17:54:24</span> 0.689    46.3  1.75  1.74</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  10.5 -<span style="color: #BB0000;">84.8</span>  633. 2022-03-28 <span style="color: #949494;">17:54:25</span> 0.714    50.0  1.56  1.53</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  10.5 -<span style="color: #BB0000;">84.8</span>  634. 2022-03-28 <span style="color: #949494;">17:54:26</span> 0.355    43.9  1.47  1.36</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  10.5 -<span style="color: #BB0000;">84.8</span>  634. 2022-03-28 <span style="color: #949494;">17:54:27</span> 0.146    23.7  1.43  1.23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  10.5 -<span style="color: #BB0000;">84.8</span>  634. 2022-03-28 <span style="color: #949494;">17:54:28</span> 0.093<span style="text-decoration: underline;">3</span>  354.   1.42  1.12</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Route 2022-03-29 10:40pm`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 8</span></span></span>
<span><span class="co">#&gt;     lat   lon   ele time                speed course  hAcc  vAcc</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  10.7 -<span style="color: #BB0000;">85.0</span>  691. 2022-03-29 <span style="color: #949494;">19:27:52</span> 0.693   222.  1.78  1.71</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  10.7 -<span style="color: #BB0000;">85.0</span>  691. 2022-03-29 <span style="color: #949494;">19:27:53</span> 0.597   220.  1.46  1.41</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  10.7 -<span style="color: #BB0000;">85.0</span>  691. 2022-03-29 <span style="color: #949494;">19:27:54</span> 0.715   217.  1.41  1.32</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  10.7 -<span style="color: #BB0000;">85.0</span>  691. 2022-03-29 <span style="color: #949494;">19:27:55</span> 0.769   209.  1.35  1.18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  10.7 -<span style="color: #BB0000;">85.0</span>  691. 2022-03-29 <span style="color: #949494;">19:27:56</span> 0.718   200.  1.32  1.08</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="initial-exploration">Initial Exploration<a class="anchor" aria-label="anchor" href="#initial-exploration"></a>
</h2>
<p>After having once parsed and saved the data as <code>rds</code>
files, it can be read and further analysed.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parsed_healthdata</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"PATH_TO_RDS/parsed_healthdata_mp.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">parsed_workouts</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"PATH_TO_RDS/parsed_apple_workouts_mp.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The full parsed file contains a large number of different variables
and data types, e.g. just the 15 most frequent ones in our example data
set:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parsed_healthdata</span><span class="op">$</span><span class="va">type</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span>decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="co">#&gt; .</span></span>
<span><span class="co">#&gt;             HKQuantityTypeIdentifierActiveEnergyBurned </span></span>
<span><span class="co">#&gt;                                                 557636 </span></span>
<span><span class="co">#&gt;                      HKQuantityTypeIdentifierHeartRate </span></span>
<span><span class="co">#&gt;                                                 292203 </span></span>
<span><span class="co">#&gt;              HKQuantityTypeIdentifierBasalEnergyBurned </span></span>
<span><span class="co">#&gt;                                                 253537 </span></span>
<span><span class="co">#&gt;         HKQuantityTypeIdentifierDistanceWalkingRunning </span></span>
<span><span class="co">#&gt;                                                 118161 </span></span>
<span><span class="co">#&gt;                HKQuantityTypeIdentifierDistanceCycling </span></span>
<span><span class="co">#&gt;                                                  88443 </span></span>
<span><span class="co">#&gt;                      HKQuantityTypeIdentifierStepCount </span></span>
<span><span class="co">#&gt;                                                  67271 </span></span>
<span><span class="co">#&gt;                HKQuantityTypeIdentifierRespiratoryRate </span></span>
<span><span class="co">#&gt;                                                  25203 </span></span>
<span><span class="co">#&gt;                   HKQuantityTypeIdentifierWalkingSpeed </span></span>
<span><span class="co">#&gt;                                                  24331 </span></span>
<span><span class="co">#&gt;              HKQuantityTypeIdentifierWalkingStepLength </span></span>
<span><span class="co">#&gt;                                                  24330 </span></span>
<span><span class="co">#&gt;                  HKCategoryTypeIdentifierSleepAnalysis </span></span>
<span><span class="co">#&gt;                                                  23878 </span></span>
<span><span class="co">#&gt;              HKQuantityTypeIdentifierAppleExerciseTime </span></span>
<span><span class="co">#&gt;                                                  22383 </span></span>
<span><span class="co">#&gt;                 HKQuantityTypeIdentifierAppleStandTime </span></span>
<span><span class="co">#&gt;                                                  22185 </span></span>
<span><span class="co">#&gt; HKQuantityTypeIdentifierWalkingDoubleSupportPercentage </span></span>
<span><span class="co">#&gt;                                                  21580 </span></span>
<span><span class="co">#&gt;                 HKCategoryTypeIdentifierAppleStandHour </span></span>
<span><span class="co">#&gt;                                                  12483 </span></span>
<span><span class="co">#&gt;                 HKQuantityTypeIdentifierPhysicalEffort </span></span>
<span><span class="co">#&gt;                                                  12198</span></span></code></pre></div>
<p>Specialized functions to pull and analyse certain specific variables
and data types can be found in the
<code><a href="../articles/02_analyse_health_data.html">vignette("02_analyse_health_data")</a></code></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Mariana Patino.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
