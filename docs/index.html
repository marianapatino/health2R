<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tbc">
<title>Import, Parse, and Analyse Health/Wearables Data in R • health2R</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Import, Parse, and Analyse Health/Wearables Data in R">
<meta property="og:description" content="tbc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">health2R</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/01_import_apple_data.html">1. Import Apple Health Data</a>
    <a class="dropdown-item" href="articles/02_analyse_health_data.html">2. Analyse Health Data</a>
    <a class="dropdown-item" href="articles/03_differential_privacy.html">3. Add Differential Privacy</a>
    <a class="dropdown-item" href="articles/04_analyse_workout_data.html">4. Analyse Workout Data</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/marianapatino/health2R/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="health2r-">health2R <img src="reference/figures/health2R_logo.png" align="right" alt="" width="140"><a class="anchor" aria-label="anchor" href="#health2r-"></a>
</h1></div>
<p>This ReadMe contains an overview of the most important functions of the <code>health2R</code> package. A full documentation for each of the respective functions can be found in the function vignettes:</p>
<ul>
<li>Import Apple Health Data: <code><a href="articles/01_import_apple_data.html">vignette("01_import_apple_data")</a></code>
</li>
<li>Analyse Health Data: <code><a href="articles/02_analyse_health_data.html">vignette("02_analyse_health_data")</a></code>
</li>
<li>Add Differential Privacy: <code><a href="articles/03_differential_privacy.html">vignette("03_differential_privacy")</a></code>
</li>
<li>Analyse Workout Data: <code><a href="articles/04_analyse_workout_data.html">vignette("04_analyse_workout_data")</a></code>
</li>
</ul>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The package can be installed from Github:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">githubinstall</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"marianapatino/health2R"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="importing-data">Importing Data<a class="anchor" aria-label="anchor" href="#importing-data"></a>
</h2>
<p>Apple Health data is stored in very large xml files which can be exported as a zip file, but have tens of millions of rows (e.g. for many data types, health data is logged and stored at the second level). Therefore, the <code>import_healthdata</code> and <code>import_workouts</code> functions take an exported zip file as input and parse it into an R data format. Due to the very large amount of rows, this can take up to several minutes, and should therefore be done once per updated health file, which can subsequently be stored as an <code>rds</code> or <code>csv</code> file.</p>
<div class="section level3">
<h3 id="importing-health-data">Importing Health Data<a class="anchor" aria-label="anchor" href="#importing-health-data"></a>
</h3>
<p>First, we import, parse and save the an example dataset of health data. A dynamic progress bar tracks the progress of the parsing process.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/marianapatino/health2R/" class="external-link">health2R</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">parsed_healthdata</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="reference/import_healthdata.html">import_healthdata</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"../dev/data/mp_export.zip"</span>,</span>
<span>                    datasource <span class="op">=</span> <span class="st">"apple"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/progressbar.png"></p>
<p>To get a first overview, we sample a random subset of 5 rows from the parsed data frame:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parsed_healthdata</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">sample_n</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 × 9</span></span>
<span><span class="co">#&gt;   type                 sourceName sourceVersion unit  device startDate          </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                &lt;chr&gt;      &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;  &lt;dttm&gt;             </span></span>
<span><span class="co">#&gt; 1 HKQuantityTypeIdent… Mariana ’… 9.1           count &lt;&lt;HKD… 2022-12-18 07:51:12</span></span>
<span><span class="co">#&gt; 2 HKQuantityTypeIdent… Mariana ’… 9.3.1         count &lt;&lt;HKD… 2023-05-05 23:23:32</span></span>
<span><span class="co">#&gt; 3 HKQuantityTypeIdent… Mariana ’… 10.0          coun… &lt;&lt;HKD… 2023-10-03 09:06:01</span></span>
<span><span class="co">#&gt; 4 HKQuantityTypeIdent… Mariana ’… 9.5.1         kcal  &lt;&lt;HKD… 2023-06-20 16:07:06</span></span>
<span><span class="co">#&gt; 5 HKQuantityTypeIdent… Mariana ’… 9.6.1         kcal  &lt;&lt;HKD… 2023-08-26 15:01:33</span></span>
<span><span class="co">#&gt; # ℹ 3 more variables: endDate &lt;dttm&gt;, creationDate &lt;dttm&gt;, value &lt;chr&gt;</span></span></code></pre></div>
<p>After the parsing is complete, we store the parsed file as an ´rds´ file:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">parsed_healthdata</span>,</span>
<span>        <span class="st">"../dev/data/parsed_healthdata_mp.rds"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="importing-workout-data">Importing Workout Data<a class="anchor" aria-label="anchor" href="#importing-workout-data"></a>
</h3>
<p>Similarly, the <code>import_workouts</code> function imports workouts as a list of <code>gpx</code> data, where the name of the individual list entries is the route name.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parsed_workouts</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="reference/import_workouts.html">import_workouts</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"../dev/data/mp_export.zip"</span>,</span>
<span>                  datasource <span class="op">=</span> <span class="st">"apple"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">parsed_workouts</span>,</span>
<span>        <span class="st">"../dev/data/parsed_apple_workouts_mp.rds"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parsed_workouts</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="op">~</span> <span class="va">.x</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`Route 2022-03-28 9:23pm`</span></span>
<span><span class="co">#&gt; # A tibble: 5 × 8</span></span>
<span><span class="co">#&gt;     lat   lon   ele time                 speed course  hAcc  vAcc</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dttm&gt;               &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1  10.5 -84.8  633. 2022-03-28 17:54:24 0.689    46.3  1.75  1.74</span></span>
<span><span class="co">#&gt; 2  10.5 -84.8  633. 2022-03-28 17:54:25 0.714    50.0  1.56  1.53</span></span>
<span><span class="co">#&gt; 3  10.5 -84.8  634. 2022-03-28 17:54:26 0.355    43.9  1.47  1.36</span></span>
<span><span class="co">#&gt; 4  10.5 -84.8  634. 2022-03-28 17:54:27 0.146    23.7  1.43  1.23</span></span>
<span><span class="co">#&gt; 5  10.5 -84.8  634. 2022-03-28 17:54:28 0.0933  354.   1.42  1.12</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="analyse-health-data">Analyse Health Data<a class="anchor" aria-label="anchor" href="#analyse-health-data"></a>
</h2>
<p>After having once parsed and saved the data as <code>rds</code> files, it can be read and further analysed.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parsed_healthdata</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"PATH_TO_RDS/parsed_healthdata_mp.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">parsed_workouts</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"PATH_TO_RDS/parsed_apple_workouts_mp.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="analyse-heart-rate-data">Analyse Heart Rate Data<a class="anchor" aria-label="anchor" href="#analyse-heart-rate-data"></a>
</h3>
<p>The dedicated function for extracting and analysing cardiovascular data is called <code>get_cardio</code> and takes as input an already parsed healthdata object, or the raw zip file. Furthermore, the variable <code>var</code> allows the user to pick which cardio-related variable should be extracted, and currently takes as options <code>heartrate</code>, <code>resting</code>, <code>walkingAverage</code>, <code>workout</code>, <code>variability</code>, and <code>recovery</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hr_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_cardio.html">get_cardio</a></span><span class="op">(</span>health_db <span class="op">=</span> <span class="va">parsed_healthdata</span>, </span>
<span>                          var <span class="op">=</span> <span class="st">"heartrate"</span><span class="op">)</span></span>
<span><span class="va">hr_data</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">type</span>,<span class="va">sourceName</span>,<span class="va">unit</span>,<span class="va">startDate</span>,<span class="va">value</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   type                              sourceName   unit  startDate           value</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                             &lt;chr&gt;        &lt;chr&gt; &lt;dttm&gt;              &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 HKQuantityTypeIdentifierHeartRate Mariana ’s … coun… 2022-03-28 05:55:33  69.9</span></span>
<span><span class="co">#&gt; 2 HKQuantityTypeIdentifierHeartRate Mariana ’s … coun… 2022-03-28 05:56:57  68  </span></span>
<span><span class="co">#&gt; 3 HKQuantityTypeIdentifierHeartRate Mariana ’s … coun… 2022-03-28 05:53:48  70  </span></span>
<span><span class="co">#&gt; 4 HKQuantityTypeIdentifierHeartRate Mariana ’s … coun… 2022-03-28 05:58:41  66  </span></span>
<span><span class="co">#&gt; 5 HKQuantityTypeIdentifierHeartRate Mariana ’s … coun… 2022-03-28 06:05:40  60  </span></span>
<span><span class="co">#&gt; 6 HKQuantityTypeIdentifierHeartRate Mariana ’s … coun… 2022-03-28 06:10:28  61</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">hr_data</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">startDate</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"\u2665"</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_datetime</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2022-03-29 00:00:00"</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2022-03-29 23:59:59"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-12-1.png"><!-- --></p>
</div>
<div class="section level3">
<h3 id="analyse-vo2-max">Analyse VO2-Max<a class="anchor" aria-label="anchor" href="#analyse-vo2-max"></a>
</h3>
<p>Furthermore, the <code>get_vo2max</code> function obtains and the VO2-Max performance data, either for the full available time range (default), of for a specific <code>start_date</code> and <code>end_date</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vo2max_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_vo2max.html">get_vo2max</a></span><span class="op">(</span>health_db <span class="op">=</span> <span class="va">parsed_healthdata</span>,</span>
<span>                          start_date <span class="op">=</span> <span class="fu">as_date</span><span class="op">(</span><span class="st">"2023-01-01"</span><span class="op">)</span>, </span>
<span>                          end_date <span class="op">=</span> <span class="fu">as_date</span><span class="op">(</span><span class="st">"2023-11-01"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can now VO2-Max (with differential noise added for privacy reasons):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">private_vo2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">vo2max_data</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>value <span class="op">=</span> <span class="va">value</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p>Plot and smoothed trend overtime:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">private_vo2</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">startDate</span>, </span>
<span>           y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_datetime</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2023-01-29 00:00:00"</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2023-10-01 00:00:00"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                     date_breaks <span class="op">=</span> <span class="st">"1 month"</span>,</span>
<span>                     date_labels <span class="op">=</span> <span class="st">"%b %y"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"VO2-Max over time (2023)"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"White noise added for additional privacy"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span>
<span><span class="co">#&gt; Warning: Removed 27 rows containing non-finite values (`stat_smooth()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 27 rows containing missing values (`geom_point()`).</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-16-1.png"><!-- --></p>
</div>
<div class="section level3">
<h3 id="analyse-menstrual-cycle">Analyse Menstrual Cycle<a class="anchor" aria-label="anchor" href="#analyse-menstrual-cycle"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">menstruation_cycle_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_menstruation_cycle.html">get_menstruation_cycle</a></span><span class="op">(</span>health_db <span class="op">=</span> <span class="va">parsed_healthdata</span><span class="op">)</span></span></code></pre></div>
<p>Of course, female menstrual cycles are a sensitive piece of data, which would not be appropriate to be exposed in this online documentation. Instead of plotting someone’s actual cycle data, we therefore simulate random data in a similar format as they would be exported by the <code>get_menstruation_cycle</code> function of the package. For further details and the source code of the <code>simulate_year_cycles</code> function, please refer to the vignette at <code><a href="articles/02_analyse_health_data.html">vignette("02_analyse_health_data")</a></code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span> <span class="co"># for reproducibility</span></span>
<span></span>
<span><span class="co"># Use the function to simulate cycles between two dates</span></span>
<span><span class="va">start_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2024-01-01"</span><span class="op">)</span></span>
<span><span class="va">end_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2024-12-31"</span><span class="op">)</span></span>
<span><span class="va">simulated_menstrual_data</span> <span class="op">&lt;-</span> <span class="fu">simulate_year_cycles</span><span class="op">(</span><span class="va">start_date</span>, <span class="va">end_date</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulated_menstrual_data</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Month <span class="op">=</span> <span class="fu">floor_date</span><span class="op">(</span><span class="va">Date</span>, <span class="st">"month"</span><span class="op">)</span>, </span>
<span>         Day <span class="op">=</span> <span class="fu">day</span><span class="op">(</span><span class="va">Date</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Day</span>,  y <span class="op">=</span> <span class="fl">1</span>,fill <span class="op">=</span> <span class="va">Menstruation</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Use tiles</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span> <span class="op">=</span> <span class="st">"red"</span>, <span class="st">"FALSE"</span> <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Month</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, </span>
<span>             labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller</a></span><span class="op">(</span>Month <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"%Y-%m-%d"</span><span class="op">)</span>, <span class="st">"%b %Y"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Custom labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Menstruation"</span>, x <span class="op">=</span> <span class="st">"Day of the Month"</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>        strip.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-20-1.png"><!-- --></p>
</div>
</div>
<div class="section level2">
<h2 id="adding-differential-privacy">Adding Differential Privacy<a class="anchor" aria-label="anchor" href="#adding-differential-privacy"></a>
</h2>
<p>Health data data can repesent quite sensitive pieces of information, which in some cases should be avoided to be leaked in an inappropriate context. To still be able to use one’s wearable data, the <code>health2R</code> package provides a function called <code>add_differential_privacy</code>, which takes a duration object as input for the variable <code>max_differential_privacy_offset</code>, and subsequently makes a data frame differentially private by adding random noise to all time stamps in the data, while retaining the relationship <em>between</em> the respective time data.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/marianapatino/health2R/" class="external-link">health2R</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span></code></pre></div>
<p>First we plot some example heart rate data:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parsed_healthdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">read_rds</a></span><span class="op">(</span><span class="st">"path/to/your/health_data.rds"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rhr_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_cardio.html">get_cardio</a></span><span class="op">(</span>health_db <span class="op">=</span> <span class="va">parsed_healthdata</span>, </span>
<span>                          var <span class="op">=</span> <span class="st">"heartrate"</span>,</span>
<span>                       start_date <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_date</a></span><span class="op">(</span><span class="st">"2023-02-28"</span><span class="op">)</span>,</span>
<span>                       end_date <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_date</a></span><span class="op">(</span><span class="st">"2023-03-02"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rhr_data</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">type</span>,<span class="va">sourceName</span>,<span class="va">unit</span>,<span class="va">startDate</span>,<span class="va">value</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 5</span></span>
<span><span class="co">#&gt;   type                              sourceName   unit  startDate           value</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                             &lt;chr&gt;        &lt;chr&gt; &lt;dttm&gt;              &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 HKQuantityTypeIdentifierHeartRate Mariana ’s … coun… 2023-02-28 00:00:07    64</span></span>
<span><span class="co">#&gt; 2 HKQuantityTypeIdentifierHeartRate Mariana ’s … coun… 2023-02-28 00:07:58    67</span></span>
<span><span class="co">#&gt; 3 HKQuantityTypeIdentifierHeartRate Mariana ’s … coun… 2023-02-28 00:04:57    66</span></span></code></pre></div>
<p>And the differentially privat data, which has been privatized with a random noise addition of up to 2 days. This duration object parameter can also hold shorter periods as appropriate, e.g. <code>duration(3600,"seconds")</code> or similar.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">priv_data</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">rhr_data</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">type</span>,<span class="va">sourceName</span>,<span class="va">unit</span>,<span class="va">startDate</span>,<span class="va">value</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="reference/add_differential_privacy.html">add_differential_privacy</a></span><span class="op">(</span>max_differential_privacy_offset <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/duration.html" class="external-link">duration</a></span><span class="op">(</span><span class="fl">2</span>,<span class="st">"days"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">priv_data</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 5</span></span>
<span><span class="co">#&gt;   type                              sourceName   unit  startDate           value</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                             &lt;chr&gt;        &lt;chr&gt; &lt;dttm&gt;              &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 HKQuantityTypeIdentifierHeartRate Mariana ’s … coun… 2023-02-27 03:01:38    64</span></span>
<span><span class="co">#&gt; 2 HKQuantityTypeIdentifierHeartRate Mariana ’s … coun… 2023-02-27 03:09:29    67</span></span>
<span><span class="co">#&gt; 3 HKQuantityTypeIdentifierHeartRate Mariana ’s … coun… 2023-02-27 03:06:28    66</span></span></code></pre></div>
<p>Plotting the two time series shows the successful addition of obfuscating noise:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combined_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">rhr_data</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"baseline_data"</span><span class="op">)</span>, </span>
<span>                       <span class="va">priv_data</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"differentially_private_data"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">combined_data</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">startDate</span>,</span>
<span>           y <span class="op">=</span> <span class="va">value</span>, </span>
<span>           col <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">type</span>,nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_datetime</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 day"</span>,</span>
<span>                   date_labels <span class="op">=</span> <span class="st">"%b %d %H:%M UTC"</span><span class="op">)</span>  <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>,vjust <span class="op">=</span> <span class="fl">1</span>,hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-25-1.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="plotting-workout-data">Plotting Workout Data<a class="anchor" aria-label="anchor" href="#plotting-workout-data"></a>
</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#devtools::install_github("EcoDynIZW/d6berlin")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">d6berlin</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.8.0, GDAL 3.0.4, PROJ 6.3.1; sf_use_s2() is TRUE</span></span></code></pre></div>
<p>We first load the list of all workouts which we previously parsed in <code><a href="articles/01_import_apple_data.html">vignette("01_import_apple_data")</a></code> and pick one specific workout:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parsed_workouts</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"path/to/workouts/rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">workout_data</span> <span class="op">&lt;-</span> <span class="va">parsed_workouts</span><span class="op">$</span><span class="va">`Route 2023-10-08 12:35pm`</span></span>
<span></span>
<span><span class="va">sf_data</span> <span class="op">&lt;-</span> <span class="va">workout_data</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lon"</span>, <span class="st">"lat"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fl">3857</span><span class="op">)</span> <span class="co"># Using Web Mercator for visualization</span></span></code></pre></div>
<p>To not leak any specific protected location, such as one’s home, we use the function <code>remove_start_end</code> which removes the first and last <code>x</code> minutes of a workout:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sf_data_obscured</span> <span class="op">&lt;-</span> <span class="fu">remove_start_end</span><span class="op">(</span><span class="va">sf_data</span>, minutes <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>We can then plot the workout and the respective velocity:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sf_data_obscured</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">speed</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Speed (m/s)"</span>, </span>
<span>                        option <span class="op">=</span> <span class="st">"C"</span>, </span>
<span>                        limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">sf_data</span><span class="op">$</span><span class="va">speed</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Workout Route with Speed Dynamics"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Latitude"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-31-1.png"><!-- --></p>
<p>To plot the workout against a real city map of Berlin, we use the <code>d6berlin</code> package:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">base_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/d6berlin/man/base_map_imp.html" class="external-link">base_map_imp</a></span><span class="op">(</span>color_intensity <span class="op">=</span> <span class="fl">1</span>, resolution <span class="op">=</span> <span class="fl">500</span>, globe <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine the base map with your data</span></span>
<span><span class="va">berlin_map</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">base_map</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sf_data_obscured</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">speed</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span>,size <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Workout Route with Speed Dynamics"</span><span class="op">)</span><span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the combined map</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">berlin_map</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-32-1.png"><!-- --></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/marianapatino/health2R/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GNU General Public License v3.0</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing health2R</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Mariana Patino <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Mariana Patino.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
